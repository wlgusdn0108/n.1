import streamlit as st
import pandas as pd

st.set_page_config(page_title="2. ESG ì ìˆ˜ ì¶”ì´ ë° í™˜ê²½ì§€í‘œ", layout="centered")

CSV_FILE = "esg_data.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
try:
    df = pd.read_csv(CSV_FILE)
except FileNotFoundError:
    st.error(f"âš ï¸ ë°ì´í„° íŒŒì¼ '{CSV_FILE}' ì´(ê°€) ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nê°™ì€ í´ë”ì— CSV íŒŒì¼ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.")
    st.stop()

# ìŠ¤íƒ€ì¼ë§
st.markdown("""
<style>
.big-title {
    font-size: 50px;
    font-weight: bold;
    color: #117A65;
    text-align: center;
    margin-bottom: 30px;
}
.subtitle {
    font-size: 22px;
    color: #145A32;
    text-align: center;
    margin-bottom: 40px;
}
.metric-value {
    font-size: 24px;
    font-weight: bold;
}
.metric-label {
    font-size: 18px;
    color: #555;
}
</style>
""", unsafe_allow_html=True)

st.markdown('<div class="big-title">ğŸ“‰ 2. ESG ì ìˆ˜ ì¶”ì´ ë° í™˜ê²½ì§€í‘œ</div>', unsafe_allow_html=True)
st.markdown('<div class="subtitle">ESG ì ìˆ˜ ë³€í™” ì¶”ì´ ë° í™˜ê²½ ì„±ê³¼ ì§€í‘œë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤.</div>', unsafe_allow_html=True)

# ESG ì ìˆ˜ ì¶”ì´ ë¼ì¸ ì°¨íŠ¸
st.subheader("ğŸ“Š ESG ì ìˆ˜ ë³€í™” ì¶”ì´")
score_chart_data = df.set_index("Year")[["ESG_Environmental", "ESG_Social", "ESG_Governance", "ESG_Overall"]]
st.line_chart(score_chart_data)

# í™˜ê²½ ì„±ê³¼ ì§€í‘œ
st.subheader("ğŸŒ¿ í™˜ê²½ ì„±ê³¼ ì§€í‘œ")

cols = st.columns(3)

with cols[0]:
    latest_val = df.iloc[-1]["CarbonEmissions"]
    st.markdown(f'<div class="metric-label">ğŸŒ íƒ„ì†Œë°°ì¶œëŸ‰ (tCOâ‚‚)</div>', unsafe_allow_html=True)
    st.markdown(f'<div class="metric-value">{latest_val}</div>', unsafe_allow_html=True)
    st.line_chart(df.set_index("Year")[["CarbonEmissions"]])

with cols[1]:
    latest_val = df.iloc[-1]["WaterUsage"]
    st.markdown(f'<div class="metric-label">ğŸ’§ ë¬¼ ì‚¬ìš©ëŸ‰ (tons)</div>', unsafe_allow_html=True)
    st.markdown(f'<div class="metric-value">{latest_val}</div>', unsafe_allow_html=True)
    st.line_chart(df.set_index("Year")[["WaterUsage"]])

with cols[2]:
    latest_val = df.iloc[-1]["EnergyConsumption"]
    st.markdown(f'<div class="metric-label">âš¡ ì—ë„ˆì§€ ì†Œë¹„ëŸ‰ (MWh)</div>', unsafe_allow_html=True)
    st.markdown(f'<div class="metric-value">{latest_val}</div>', unsafe_allow_html=True)
    st.line_chart(df.set_index("Year")[["EnergyConsumption"]])

st.markdown("---")
st.markdown("> ğŸ’¡ ESG ì ìˆ˜ì˜ ì¶”ì´ì™€ í™˜ê²½ ì§€í‘œ ë³€í™”ë¥¼ í•¨ê»˜ íŒŒì•…í•˜ì—¬ ê¸°ì—…ì˜ ì§€ì†ê°€ëŠ¥ì„± ê°œì„  ë°©í–¥ì„ ëª¨ìƒ‰í•©ë‹ˆë‹¤.")
