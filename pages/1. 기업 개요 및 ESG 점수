import streamlit as st
import pandas as pd

st.set_page_config(page_title="1. ê¸°ì—… ê°œìš” ë° ESG ì ìˆ˜", layout="centered")

CSV_FILE = "esg_data.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
try:
    df = pd.read_csv(CSV_FILE)
except FileNotFoundError:
    st.error(f"âš ï¸ ë°ì´í„° íŒŒì¼ '{CSV_FILE}' ì´(ê°€) ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nê°™ì€ í´ë”ì— CSV íŒŒì¼ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.")
    st.stop()

def get_grade(score):
    if score >= 80:
        return "A (ìš°ìˆ˜)"
    elif score >= 60:
        return "B (ë³´í†µ)"
    elif score >= 40:
        return "C (ì£¼ì˜)"
    else:
        return "D (ìœ„í—˜)"

# ë“±ê¸‰ ì»¬ëŸ¼ ì¶”ê°€
df["Environmental_Grade"] = df["ESG_Environmental"].apply(get_grade)
df["Social_Grade"] = df["ESG_Social"].apply(get_grade)
df["Governance_Grade"] = df["ESG_Governance"].apply(get_grade)
df["ESG_Grade"] = df["ESG_Overall"].apply(get_grade)

# ì œëª©
st.markdown("""
<style>
.big-title {
    font-size: 50px;
    font-weight: bold;
    color: #1F618D;
    text-align: center;
    margin-bottom: 30px;
}
.subtitle {
    font-size: 22px;
    color: #2E4053;
    text-align: center;
    margin-bottom: 40px;
}
.data-table {
    font-size: 20px;
}
</style>
""", unsafe_allow_html=True)

st.markdown('<div class="big-title">ğŸ“Š 1. ê¸°ì—… ê°œìš” ë° ESG ì ìˆ˜</div>', unsafe_allow_html=True)
st.markdown('<div class="subtitle">ì„ íƒí•œ ê¸°ê°„ ë‚´ ê¸°ì—…ì˜ ESG ì ìˆ˜ ë° ë“±ê¸‰ì„ í™•ì¸í•©ë‹ˆë‹¤.</div>', unsafe_allow_html=True)

# ê¸°ì—… ì •ë³´
st.markdown(f"""
**ê¸°ì—…ëª…**: `{df['CompanyName'].iloc[0]}`  
**ì‚°ì—…êµ°**: `{df['Industry'].iloc[0]}`  
**ì§€ì—­**: `{df['Region'].iloc[0]}`
""")

# ESG ì ìˆ˜ ë° ë“±ê¸‰ í…Œì´ë¸” (ì „ì²´ ë°ì´í„° ì¶œë ¥)
st.dataframe(df[[
    "Year", "ESG_Environmental", "Environmental_Grade",
    "ESG_Social", "Social_Grade",
    "ESG_Governance", "Governance_Grade",
    "ESG_Overall", "ESG_Grade"
]].style.set_properties(**{'font-size': '18px'}))

# ë°œí‘œììš© ë©”ì‹œì§€ (ì›í•˜ë©´ ì¶”ê°€)
st.markdown("---")
st.markdown("> ğŸ’¡ ì£¼ìš” ì—°ë„ë³„ ESG ì ìˆ˜ì™€ ë“±ê¸‰ì„ í†µí•´ ê¸°ì—…ì˜ ì§€ì†ê°€ëŠ¥ì„± í˜„í™©ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
